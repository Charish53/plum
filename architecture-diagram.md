# AI-Powered Amount Detection Architecture Diagram

## System Architecture Overview

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           AI-Powered Amount Detection System                    │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │   Backend API   │    │   OCR Service   │    │   AI Service    │
│   (React)       │    │   (Express.js)  │    │   (PaddleOCR)   │    │   (Gemini AI)   │
└─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │                       │
         │                       │                       │                       │
         ▼                       ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ • Image Upload  │    │ • REST API      │    │ • Text          │    │ • LLM           │
│ • Text Input    │    │ • Controllers   │    │   Extraction    │    │   Processing    │
│ • Results       │    │ • Services      │    │ • Bounding      │    │ • Fallback      │
│   Display       │    │ • Middleware    │    │   Boxes         │    │   Mechanisms    │
└─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 4-Step Amount Extraction Pipeline

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           4-Step Amount Extraction Pipeline                     │
└─────────────────────────────────────────────────────────────────────────────────┘

    Input Text
         │
         ▼
┌─────────────────┐
│   Step 1:       │
│   Raw Token     │
│   Extraction    │
└─────────────────┘
         │
         ▼
┌─────────────────┐
│   Step 2:       │
│   Amount        │
│   Normalization │
└─────────────────┘
         │
         ▼
┌─────────────────┐
│   Step 3:       │
│   Context       │
│   Classification│
└─────────────────┘
         │
         ▼
┌─────────────────┐
│   Step 4:       │
│   Final Output  │
│   Generation    │
└─────────────────┘
         │
         ▼
    Structured
    Amount Data
```

## API Endpoints Flow

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              API Endpoints Flow                                 │
└─────────────────────────────────────────────────────────────────────────────────┘

Frontend Request
         │
         ▼
┌─────────────────┐
│   POST          │
│   /api/ocr-     │
│   with-boxes    │
└─────────────────┘
         │
         ▼
┌─────────────────┐
│   POST          │
│   /api/amount-  │
│   extraction/   │
│   pipeline      │
└─────────────────┘
         │
         ▼
    Final Response
```

## Data Flow Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Data Flow Architecture                             │
└─────────────────────────────────────────────────────────────────────────────────┘

Medical Bill Image
         │
         ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   OCR Service   │───▶│   Text          │───▶│   AI Service    │
│   (PaddleOCR)   │    │   Extraction    │    │   (Gemini)      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Bounding      │    │   Raw Text      │    │   Structured    │
│   Boxes         │    │   Content       │    │   Data          │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Amount        │    │   Amount        │    │   Amount        │
│   Extraction    │    │   Extraction    │    │   Extraction    │
│   Pipeline      │    │   Pipeline      │    │   Pipeline      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Final         │    │   Final         │    │   Final         │
│   Results       │    │   Results       │    │   Results       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## Component Interaction Diagram

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Component Interaction Diagram                         │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────┐
│   Frontend      │
│   (React)       │
└─────────────────┘
         │
         │ HTTP Requests
         ▼
┌─────────────────┐
│   Backend       │
│   Controller    │
└─────────────────┘
         │
         │ Service Calls
         ▼
┌─────────────────┐    ┌─────────────────┐
│   OCR Service   │    │   Amount        │
│   Adapter       │    │   Extraction    │
└─────────────────┘    │   Service       │
         │              └─────────────────┘
         │                       │
         ▼                       ▼
┌─────────────────┐    ┌─────────────────┐
│   PaddleOCR     │    │   Gemini AI     │
│   Engine        │    │   Service       │
└─────────────────┘    └─────────────────┘
         │                       │
         ▼                       ▼
┌─────────────────┐    ┌─────────────────┐
│   Text +        │    │   LLM +         │
│   Bounding      │    │   Regex         │
│   Boxes         │    │   Fallback      │
└─────────────────┘    └─────────────────┘
```

## Error Handling & Fallback Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        Error Handling & Fallback Architecture                   │
└─────────────────────────────────────────────────────────────────────────────────┘

Primary Processing
         │
         ▼
┌─────────────────┐
│   Gemini AI     │
│   Processing    │
└─────────────────┘
         │
         │ Success
         ▼
┌─────────────────┐
│   LLM Results   │
└─────────────────┘
         │
         │ Failure
         ▼
┌─────────────────┐
│   Fallback      │
│   Mechanism     │
└─────────────────┘
         │
         ▼
┌─────────────────┐
│   Regex-based   │
│   Processing    │
└─────────────────┘
         │
         ▼
┌─────────────────┐
│   Fallback      │
│   Results       │
└─────────────────┘
```

## Deployment Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Deployment Architecture                            │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────┐
│   Client        │
│   Browser       │
└─────────────────┘
         │
         │ HTTP/HTTPS
         ▼
┌─────────────────┐
│   Load          │
│   Balancer      │
└─────────────────┘
         │
         ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │   Backend       │    │   External      │
│   Server        │    │   Server        │    │   Services      │
│   (Port 3000)   │    │   (Port 3002)   │    │   (Gemini API)  │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Static        │    │   Node.js       │    │   Google        │
│   Files         │    │   Application   │    │   Cloud         │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                │
                                ▼
                       ┌─────────────────┐
                       │   PaddleOCR     │
                       │   Engine        │
                       └─────────────────┘
```

## Technology Stack

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                Technology Stack                                 │
└─────────────────────────────────────────────────────────────────────────────────┘

Frontend:
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   React 18      │    │   HTML5/CSS3    │    │   JavaScript    │
│   (CDN)         │    │   (Modern)      │    │   (ES6+)        │
└─────────────────┘    └─────────────────┘    └─────────────────┘

Backend:
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Node.js       │    │   Express.js    │    │   TypeScript    │
│   (Runtime)     │    │   (Framework)   │    │   (Language)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘

OCR & AI:
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   PaddleOCR     │    │   Google        │    │   ONNX Runtime  │
│   (Engine)      │    │   Gemini AI     │    │   (Inference)   │
└─────────────────┘    └─────────────────┘    └─────────────────┘

Infrastructure:
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Docker        │    │   Nginx         │    │   PM2           │
│   (Container)   │    │   (Proxy)       │    │   (Process)     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## Security & Compliance

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            Security & Compliance                                │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Input         │    │   Processing    │    │   Output        │
│   Validation    │    │   Security      │    │   Protection    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   File Type     │    │   API Key       │    │   Data          │
│   Validation    │    │   Encryption    │    │   Sanitization  │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Size Limits   │    │   Rate          │    │   Audit         │
│   & Checks      │    │   Limiting      │    │   Logging       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## Performance Metrics

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                Performance Metrics                              │
└─────────────────────────────────────────────────────────────────────────────────┘

OCR Processing:
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Image         │    │   Text          │    │   Bounding      │
│   Processing    │    │   Extraction    │    │   Boxes         │
│   2-5 seconds   │    │   1-3 seconds   │    │   0.5-2 seconds │
└─────────────────┘    └─────────────────┘    └─────────────────┘

AI Processing:
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   LLM           │    │   Regex         │    │   Complete      │
│   Processing    │    │   Fallback      │    │   Pipeline      │
│   2-5 seconds   │    │   100-500ms     │    │   3-8 seconds   │
└─────────────────┘    └─────────────────┘    └─────────────────┘

Confidence Scoring:
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Raw Token     │    │   Normalization │    │   Classification│
│   0.0 - 1.0     │    │   0.9 (success) │    │   0.8 - 0.9     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

